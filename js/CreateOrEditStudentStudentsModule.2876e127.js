(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CreateOrEditStudentStudentsModule"],{3482:function(t,e,a){"use strict";a.r(e);var n=a("8336"),i=a("62ad"),s=a("132d"),r=a("0fd9"),o=a("2fa4"),d=a("71d9"),l=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e(d["a"],[e("div",{staticClass:"d-flex align-center"},[e(s["a"],{staticClass:"mx-1",attrs:{large:""}},[t._v("mdi-account-circle")]),e("span",{staticClass:"font-weight-bold text-xs-caption text-sm-h6"},[t._v(t._s(t.getTitleByUserDataForUpdateOrCreate))])],1),e(o["a"])],1),e("validation-observer",{ref:"FormCreateOrEditStudent",scopedSlots:t._u([{key:"default",fn:function({invalid:a}){return[e("section",{staticClass:"px-2 py-2 d-flex align-center"},[e(r["a"],{attrs:{dense:""}},[e(i["a"],{attrs:{cols:"12",sm:"12",md:"6",lg:"4"}},[e("dni-field-input",{ref:"DNIPersonInputComponent",attrs:{rules:"requiredDniNie|ItMustBeADniOrNieFromSpain","is-disabled":t.isUpdateUser},on:{DniBinding:function(e){t.form.dni=e}}})],1),e(i["a"],{attrs:{cols:"12",sm:"12",md:"6",lg:"4"}},[e("name-field-input",{ref:"namePersonInputComponent",attrs:{rules:"requiredFirstName|min:3|max:25|mustContainLettersAndOptionalTilde"},on:{NamePersonBinding:function(e){t.form.firstName=e}}})],1),e(i["a"],{attrs:{cols:"12",sm:"12",md:"6",lg:"4"}},[e("last-name-field-input",{ref:"LastNamePersonInputComponent",attrs:{rules:"requiredLastName|min:3|max:25|mustContainLettersAndOptionalTilde"},on:{LastNamePersonBinding:function(e){t.form.lastName=e}}})],1),e(i["a"],{attrs:{cols:"12",sm:"12",md:"6",lg:"4"}},[e("phone-field-input",{ref:"PhoneInputComponent",attrs:{rules:"requiredPhone|numeric|ItMustBeAPhoneNumberFromSpain"},on:{PhoneBinding:function(e){t.form.phone=e}}})],1),e(i["a"],{attrs:{cols:"12",sm:"12",md:"12",lg:"8"}},[e("email-field-input",{ref:"EmailInputComponent",attrs:{rules:"requiredEmail|email"},on:{EmailBinding:function(e){t.form.email=e}}})],1),e(i["a"],{staticClass:"d-flex flex-column flex-sm-row",attrs:{cols:"12"}},[null===t.currentUserForUpdate?e(n["a"],{staticClass:"mt-2 ml-2 white--text",attrs:{loading:t.loadingButtonCreateOrUpdateStudent,disabled:t.disabledButtonCreateOrUpdateStudent||a,color:"light-blue darken-3",block:t.activeStyleBlockButton},on:{click:t.CreateOrUpdateStudent}},[e(s["a"],{staticClass:"mr-1",attrs:{right:"",dark:""}},[t._v(" mdi-account-multiple-plus ")]),t._v(" Crear ")],1):t._e(),null!==t.currentUserForUpdate&&t.isUpdateStudent?e(n["a"],{staticClass:"mt-2 ml-2 white--text",attrs:{loading:t.loadingButtonCreateOrUpdateStudent,disabled:t.disabledButtonCreateOrUpdateStudent||a,color:"light-blue darken-3",block:t.activeStyleBlockButton},on:{click:t.CreateOrUpdateStudent}},[e(s["a"],{staticClass:"mx-1",attrs:{right:"",dark:""}},[t._v(" mdi-reload ")]),t._v(" Actualizar ")],1):t._e(),null!==t.currentUserForUpdate&&t.isUpdateStudent?e(n["a"],{staticClass:"mt-2 ml-2 white--text",attrs:{loading:t.loadingButtonCreateOrUpdateStudent,color:"red",block:t.activeStyleBlockButton},on:{click:t.resetDataAndProcessEditStudent}},[e(s["a"],{staticClass:"mx-1",attrs:{right:"",dark:""}},[t._v(" mdi-close-circle ")]),t._v(" Cancelar ")],1):t._e()],1)],1)],1)]}}])})],1)},u=[],m={components:{DniFieldInput:()=>a.e("DNIFieldInput").then(a.bind(null,"aed2")),NameFieldInput:()=>a.e("NameFieldInput").then(a.bind(null,"b350")),LastNameFieldInput:()=>a.e("LastNameFieldInput").then(a.bind(null,"5ee5")),PhoneFieldInput:()=>a.e("PhoneFieldInput").then(a.bind(null,"eab9")),EmailFieldInput:()=>a.e("EmailFieldInput").then(a.bind(null,"33d7"))}},h={data(){return{loadingButtonCreateOrUpdateStudent:!1,disabledButtonCreateOrUpdateStudent:!1,isUpdateStudent:!1,form:{dni:"",firstName:"",lastName:"",phone:"",email:""},cache:{data:{student:{firstName:"",lastName:"",phone:"",email:""}}},dataRoleStudent:null}}},c=a("2f62"),p={methods:{...Object(c["b"])("studentsService",["getStudents","createStudent","updateStudent","fetchRoleStudentData"]),...Object(c["d"])("studentsService",["SET_CURRENT_USER_FOR_UPDATE"]),cancelProcessEditStudentData(){this.isUpdateStudent?this.loadDataUserForUpdate(this.currentUserForUpdate):this.ResetForm()},resetDataAndProcessEditStudent(){this.cache.data.student.firstName=null,this.cache.data.student.lastName=null,this.cache.data.student.phone=null,this.cache.data.student.email=null,this.ResetForm(),this.isUpdateStudent=!1,this.SET_CURRENT_USER_FOR_UPDATE(null)},loadDataUserForUpdate(t){const{dni:e,first_name:a,last_name:n,phone:i,email:s}=t;this.$refs["DNIPersonInputComponent"].dni=e,this.$refs["namePersonInputComponent"].name_person=a,this.$refs["LastNamePersonInputComponent"].last_name=n,this.$refs["PhoneInputComponent"].phone=i,this.$refs["EmailInputComponent"].email=s,this.form.dni=e,this.form.firstName=a,this.form.lastName=n,this.form.phone=i,this.form.email=s,this.cache.data.student.firstName=a,this.cache.data.student.lastName=n,this.cache.data.student.phone=i,this.cache.data.student.email=s,this.isUpdateStudent=!0},ResetForm(){return this.$refs["DNIPersonInputComponent"].dni="",this.$refs["namePersonInputComponent"].name_person="",this.$refs["LastNamePersonInputComponent"].last_name="",this.$refs["PhoneInputComponent"].phone="",this.$refs["EmailInputComponent"].email="",this.form.dni="",this.form.firstName="",this.form.lastName="",this.form.phone="",this.form.email="",this.$nextTick(()=>{this.$refs["FormCreateOrEditStudent"]["reset"]()}),!0},CreateOrUpdateStudent(){this.$refs["FormCreateOrEditStudent"].validate().then(t=>{t?(this.$loadingApp.enableLoadingProgressLinear(),this.loadingButtonCreateOrUpdateStudent=!0,this.disabledButtonCreateOrUpdateStudent=!0,null===this.currentUserForUpdate?this.createStudentApi():this.updateProfileApi()):this.$swal.fire({icon:"error",toast:!0,title:"Por favor, complete correctamente los campos del formulario.",showConfirmButton:!0,confirmButtonText:"Entendido",timer:7500})})},async handlingErrorValidation(t={}){await this.$refs["FormCreateOrEditStudent"]["setErrors"](t),this.loadingButtonCreateOrUpdateStudent=!1,this.disabledButtonCreateOrUpdateStudent=!1,this.$loadingApp.disabledLoadingProgressLinear()}}},f={computed:{...Object(c["e"])("studentsService",["currentUserForUpdate","tabViewStudents"]),checkIfThereIsAtLeast_1ModifiedData(){const{firstName:t,lastName:e,phone:a,email:n}=this.cache.data.student;return t!==this.form.firstName||e!==this.form.lastName||a!==this.form.phone||n!==this.form.email},textButtonCancelDataEditStudent(){return this.isUpdateStudent?"Revertir cambios":"Cancelar proceso"},cancelProcessFormStudent(){return this.form.dni||this.form.firstName||this.form.lastName||this.form.phone||this.form.email},getTitleByUserDataForUpdateOrCreate(){return null===this.currentUserForUpdate?"Crear alumno":"Editar alumno"},activeStyleBlockButton(){return this.$vuetify.breakpoint.width<=600},isUpdateUser(){return null!==this.currentUserForUpdate}}},S={watch:{currentUserForUpdate(t){null!==t?this.loadDataUserForUpdate(t):this.ResetForm()}}},U={methods:{async fetchDataRoleStudent(){try{const t=await this.fetchRoleStudentData({config:{}});this.dataRoleStudent=t.data.data}catch(t){}},async createStudentApi(){try{await this.createStudent({data:{dni:this.form.dni,"first-name":this.form.firstName,"last-name":this.form.lastName,phone:this.form.phone,email:this.form.email,roles:[this.dataRoleStudent.id]},config:{}}),this.$swal.fire({icon:"success",toast:!0,title:"El alumno ha sido registrado con éxito.",timer:1e4}),this.$loadingApp.disabledLoadingProgressLinear(),this.loadingButtonCreateOrUpdateStudent=!1,this.disabledButtonCreateOrUpdateStudent=!1,this.ResetForm(),this.SET_CURRENT_USER_FOR_UPDATE(null),this.$emit("SuccessfullyProcessCreateOrUpdateStudent"),this.$emit("emitReloadDatatableStudents")}catch(e){var t;this.$loadingApp.disabledLoadingProgressLinear(),this.loadingButtonCreateOrUpdateStudent=!1,this.disabledButtonCreateOrUpdateStudent=!1,void 0===e.response?this.$swal.fire({icon:"error",title:"Ha ocurrido un problema en la aplicación. Reportelo e intente más tarde",showConfirmButton:!0,confirmButtonText:"¡Entendido!",timer:7500}):422===(null===(t=e.response)||void 0===t?void 0:t.status)&&this.handlingErrorValidation(e.response.data.errors)}},async updateProfileApi(){try{await this.updateStudent({id:this.currentUserForUpdate.id,data:{"first-name":this.form.firstName,"last-name":this.form.lastName,phone:this.form.phone,email:this.form.email,roles:[this.dataRoleStudent.id]},config:{}}),this.$swal.fire({icon:"success",toast:!0,title:"Alumno actualizado correctamente.",timer:1e4}),this.$loadingApp.disabledLoadingProgressLinear(),this.loadingButtonCreateOrUpdateStudent=!1,this.disabledButtonCreateOrUpdateStudent=!1,this.ResetForm(),this.SET_CURRENT_USER_FOR_UPDATE(null),this.$emit("SuccessfullyProcessCreateOrUpdateStudent"),this.loadStudentsFromCurrentTab(),this.$emit("emitReloadDatatableStudents")}catch(e){var t;this.$loadingApp.disabledLoadingProgressLinear(),this.loadingButtonCreateOrUpdateStudent=!1,this.disabledButtonCreateOrUpdateStudent=!1,void 0===e.response?this.$swal.fire({icon:"error",title:"Ha ocurrido un problema en la aplicación. Reportelo e intente más tarde",showConfirmButton:!0,confirmButtonText:"¡Entendido!",timer:7500}):422===(null===(t=e.response)||void 0===t?void 0:t.status)&&this.handlingErrorValidation(e.response.data.errors)}}}},C=a("82bb"),g={mixins:[C["a"],m,h,p,U,f,S],mounted(){this.fetchDataRoleStudent()}},b=g,N=a("2877"),F=Object(N["a"])(b,l,u,!1,null,null,null);e["default"]=F.exports}}]);